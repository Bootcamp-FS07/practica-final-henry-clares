@if (post) {
  <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-4 space-y-2">
    <div class="flex justify-between items-start">
      <div class="flex-col items-center gap-2 pb-2">
        <p class="font-semibold">&#64;{{ post.author.username }}</p>
        <p class="text-xs text-gray-600 dark:text-gray-400">
          {{ post.createdAt | date: 'medium' }}
        </p>
      </div>

      @if (isOwner()) {
        <div class="relative">
          <button
            type="button"
            class="btn-icon p-0"
            (click)="post.openMenu = !post.openMenu"
          >
            <ng-icon name="heroEllipsisVertical"></ng-icon>
          </button>
          @if (post.openMenu) {
            <div
              class="absolute right-0 mt-2 w-44 bg-white divide-y divide-gray-100 rounded-lg shadow-md dark:bg-gray-700 dark:divide-gray-600 z-10"
            >
              <ul>
                <li>
                  <button
                    type="button"
                    class="menu-item cursor-pointer w-full text-start flex items-center gap-2"
                    (click)="startEditing(post)"
                  >
                    <ng-icon name="heroPencilSquare"></ng-icon>
                    Edit
                  </button>
                </li>
                <li>
                  <button
                    type="button"
                    class="menu-item cursor-pointer w-full text-start flex items-center gap-2"
                    (click)="openModal(); post.openMenu = false"
                  >
                    <ng-icon name="heroTrash"></ng-icon>
                    Delete
                  </button>
                </li>
              </ul>
            </div>
          }
        </div>
        @if (showModal) {
          <app-confirm-modal
            *ngIf="showModal"
            title="Delete Post"
            message="Are you sure you want to delete this post?"
            (okAction)="deletePost(post._id)"
            (cancelAction)="closeModal()"
          ></app-confirm-modal>
        }
      }
    </div>

    @if (!post.editing) {
      <div class="pb-2">
        <p class="text-gray-600 dark:text-gray-300">{{ post.text }}</p>
      </div>
    }

    @if (post.editing) {
      <form
        [formGroup]="editPostForm"
        (ngSubmit)="editPost(post); post.editing = false"
      >
        <textarea
          placeholder="Write something..."
          class="input-form w-full p-2 border rounded mb-2"
          formControlName="text"
          (value)="(post.text)"
        ></textarea>
        <div class="flex justify-end gap-2">
          <button class="btn btn-secondary" (click)="post.editing = false">
            Cancel
          </button>

          <button
            type="submit"
            class="btn bg-green-500 text-white"
            [disabled]="editPostForm.invalid"
          >
            Save
          </button>
        </div>
      </form>
    }

    <div class="mt-2 flex items-center gap-2">
      <input placeholder="Add a comment..." class="input-form flex-grow" />
      <button type="button" class="btn btn-primary w-10 h-10">
        <ng-icon name="heroPaperAirplane"></ng-icon>
      </button>
    </div>
  </div>
}
